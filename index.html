<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>山东省城乡居民养老保险精细测算器</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="container">
    <div class="header">
        <h1>📊 山东居民养老金精细测算</h1>
        <div class="header-subtitle">城乡居民基本养老保险待遇智能计算工具</div>
    </div>

    <div class="card">
        <h2>
            <span><span class="section-icon">1</span>基础信息</span>
        </h2>
        <div class="form-group">
            <label>当前年份</label>
            <input type="number" id="currentYear" readonly>
        </div>
        <div class="form-group">
            <label>出生年份</label>
            <input type="number" id="birthYear" value="1970" onchange="renderYearlyInputs()" inputmode="numeric">
        </div>
        <div class="form-group">
            <label>目前累计缴费年限 (年)</label>
            <input type="number" id="pastYears" value="16" inputmode="numeric">
        </div>
        <div class="form-group">
            <label>本年初个人账户已有余额 (元)</label>
            <input type="number" id="currentBalance" value="10000" inputmode="decimal">
        </div>
        
        <div class="divider"></div>
        
        <h2>
            <span><span class="section-icon">2</span>政策参数配置</span>
        </h2>
        <div class="form-group">
            <label>基础养老金最低标准 (元/月)</label>
            <input type="number" id="basePension" value="208" inputmode="numeric">
        </div>
        <div class="form-group">
            <label>长缴激励标准 (元/年)</label>
            <input type="number" id="bonusRate" value="3" inputmode="numeric">
            <div class="hint">缴费年限超过15年后，每超过1年基础养老金增加金额</div>
        </div>
        <div class="form-group">
            <label>账户年化利率 (%)</label>
            <input type="number" id="interestRate" value="3.63" step="0.1" inputmode="decimal">
        </div>
        <div class="form-group">
            <label>政府缴费补贴规则</label>
            <div class="subsidy-info">
                <div>根据每年缴费档位自动将补贴计入余额：</div>
                <ul>
                    <li><strong>350档位：</strong> 补贴 30 元/年</li>
                    <li><strong>500档位：</strong> 补贴 50 元/年</li>
                    <li><strong>800及以上：</strong> 补贴 80 元/年</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>
            <span><span class="section-icon">3</span>未来缴费规划</span>
            <div class="toggle-container">
                <button class="toggle-btn active" id="modeSimple" onclick="toggleMode('simple')">固定金额</button>
                <button class="toggle-btn" id="modeDetailed" onclick="toggleMode('detailed')">逐年设定</button>
            </div>
        </h2>

        <div id="remainingInfo"></div>

        <div id="simpleModePanel">
            <div class="form-group">
                <label>每年个人缴纳档位</label>
                <select id="simplePersonal"></select>
            </div>
            <div class="form-group">
                <label>每年子女资助档位</label>
                <select id="simpleChild">
                    <option value="0">无资助 (¥0)</option>
                </select>
            </div>
            <div class="hint">该模式假设未来每年的缴费金额都一样 (含退休当年)</div>
        </div>

        <div id="detailedModePanel" style="display: none;">
            <div class="col-header">
                <span>年份</span>
                <span>个人缴纳</span>
                <span>子女资助</span>
            </div>
            <div id="dynamicYearsContainer"></div>
            <div class="hint">橙色年份为退休当年，如生日前可缴费请选择金额，否则选0</div>
        </div>

        <button class="action-btn" onclick="calculate()">🚀 开始测算</button>
    </div>

    <div class="card full-width" id="resultCard" style="display:none;">
        <h2>
            <span><span class="section-icon">4</span>测算结果</span>
        </h2>
        
        <div class="result-grid">
            <div class="result-box">
                <div class="result-title">🎂 退休时间（60岁）</div>
                <div class="result-val" id="resRetireYear">--</div>
                <div class="breakdown">总缴费年限: <span id="resTotalYears">--</span></div>
            </div>
            <div class="result-box">
                <div class="result-title">💰 账户总积累</div>
                <div class="result-val" id="resTotalBalance">¥0</div>
                <div class="breakdown">本金 + 利息 + 政府补贴</div>
            </div>
            <div class="result-box">
                <div class="result-title">📈 退休后首月领取</div>
                <div class="result-val" id="resFirstMonth">¥0</div>
                <div class="breakdown">含基础及个人部分</div>
            </div>
        </div>

        <div class="table-wrapper">
            <table class="result-table">
                <thead>
                    <tr>
                        <th>年龄段</th>
                        <th>月领取总额</th>
                        <th>基础养老金<span class="sub-text">含长缴/高龄补贴</span></th>
                        <th>个人账户<span class="sub-text" style="color:var(--primary)">余额÷139</span></th>
                    </tr>
                </thead>
                <tbody id="resultTableBody"></tbody>
            </table>
        </div>

        <div class="charts-container">
            <div class="chart-box">
                <canvas id="pieChart"></canvas>
            </div>
            <div class="chart-box">
                <canvas id="lineChart"></canvas>
            </div>
        </div>
    </div>
</div>

<script src="app.js"></script>

</body>
</html>